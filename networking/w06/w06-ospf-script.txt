! OSPF Configuration Script for {user} Network
! {u} = your magic number
! {x} = the switch number
! {user} = your college id

! basic config
! edge router - {user}-EDGE

hostname {user}-EDGE
enable secret class
username admin privilege 15 secret cisco
service password-encryption

line vty 0 15
    login local
    transport input ssh
    logging synchronous
exit

line console 0
    logging synchronous
exit

ip domain-name cnap.cst
crypto key gen rsa general-keys modulus 2048
no ip domain-lookup

ntp master 4
logging host 10.{u}.20.20
logging trap informational
logging source-interface lo100

interface lo100
    ip address 10.{u}.100.1 255.255.255.255
exit

interface g0/0/0
    ip address 203.0.113.{u} 255.255.255.0
exit

interface g0/0/1
    ip address 10.{u}.12.1 255.255.255.248
exit

interface g0/0/2
    ip address 10.{u}.13.1 255.255.255.248
exit

no ip tftp source-interface

! dist router - {user}-DIST

hostname {user}-DIST
enable secret class
username admin privilege 15 secret cisco
service password-encryption

line vty 0 15
    login local
    transport input ssh
    logging synchronous
exit

line console 0
    logging synchronous
exit

ip domain-name cnap.cst
crypto key generate rsa general-keys modulus 2048
no ip domain-lookup

ntp server 10.{u}.100.1
logging host 10.{u}.20.20
logging trap informational
logging source-interface lo100

interface lo100
    ip address 10.{u}.100.3 255.255.255.255
exit

interface g0/0/1
    ip address 10.{u}.13.3 255.255.255.248
exit

interface g0/0/2
    ip address 10.{u}.23.3 255.255.255.248
exit

no ip tftp source-interface

! core switch - {user}-CORE

hostname {user}-CORE
enable secret class
username cisco privilege 15 secret class
service password-encryption

line vty 0 15
    login local
    transport input ssh
    logging synchronous
exit

line console 0
    logging synchronous
exit

ip domain-name cnap.cst
crypto key generate rsa general-keys modulus 2048
no ip domain-lookup
ip routing

ntp server 10.{u}.100.1
logging host 10.{u}.20.20
logging trap informational
logging source-interface lo100

vlan 20
    name {user}-VLAN20
exit

vlan 666
    name {user}-VLAN666
exit

interface lo100
    ip address 10.{u}.100.1 255.255.255.255
exit

interface g{x}/0/1
    no switchport
    ip address 10.{u}.12.2 255.255.255.248
exit

interface g{x}/0/2
    no switchport
    ip address 10.{u}.23.2 255.255.255.248
exit

interface vlan20
    ip address 10.{u}.20.2 255.255.255.0
exit

interface g{x}/0/20
    no shutdown
	switchport mode access
    switchport access vlan 20
exit

no ip tftp source-interface

! default route on edge router
ip route 0.0.0.0 0.0.0.0 g0/0/0 203.0.113.254

! on edge router

router ospf {u}
    router-id 10.{u}.100.1
    auto ref 10000
    default-information originate
exit

interface lo100
    ip ospf {u} area 0
exit

interface range g0/0/1-2
    ip ospf {u} area 0
exit

! on core switch

router ospf {u}
    router-id 10.{u}.100.2
    auto ref 10000
exit

interface lo100
    ip ospf {u} area 0
exit

interface range g{x}/0/1-2 g{x}/0/20
    ip ospf {u} area 0
exit

interface vlan20
    ip ospf {u} area 0
exit

router ospf {u}
    passive-interface vlan20
exit

! on dist router

router ospf {u}
    router-id 10.{u}.100.3
    auto ref 10000
exit

interface lo100
    ip ospf {u} area 0
exit

interface range g0/0/1-2
    ip ospf {u} area 0
exit

! change ospf network type to p2p on edge-dist
! on edge router

interface g0/0/1
    ip ospf network point-to-point
exit

! change network type to p2p on the edge-dist link & make dist win the DR election
! on dist router

interface g0/0/2
    ip ospf priority {u}
exit

! Reduce OSPF timers: set Hello = 3 and Dead = 10 (confirm these are compatible with the neighbour). On COREâ€“DIST:
! on core switch

interface g{x}/0/1
    ip ospf network point-to-point
exit

interface g{x}/0/2
    ip ospf priority 0
    ip ospf hello-interval 3
    ip ospf dead-interval 10
exit

clear ip ospf process

! on dist router

interface g0/0/2
    ip ospf priority {u}
    ip ospf hello-interval 3
    ip ospf dead-interval 10
exit

clear ip ospf process

! update ospf router-id to 0.0.0.{u} on edge router

router ospf {u}
    router-id 0.0.0.{u}
exit

clear ip ospf process

! TASK 2
! on mikrotik CLOUD-GW

/interface set 0 name=ether1
/interface set 1 name=ether2

/system identity set name={user}-CLOUD-GW

/interface bridge add name=Lo100

/ip addr add address=10.{u}.45.4/29 interface=ether1 network=10.{u}.45.0
/ip addr add address=10.{u}.23.4/29 interface=ether2 network=10.{u}.23.0
/ip addr add address=10.{u}.100.4/32 interface=Lo100 network=10.{u}.100.4

/routing ospf instance add name=OSPF-{u} router-id=10.{u}.100.4

/routing ospf area add instance=OSPF-{u} name=AREA-0 area-id=0.0.0.0

/routing ospf interface-template add area=AREA-0 interfaces=Lo100
/routing ospf interface-template add area=AREA-0 interfaces=ether1
/routing ospf interface-template add area=AREA-0 interfaces=ether2 priority=255

! on mikrotik CLOUD-SPK

/system identity set name={user}-CLOUD-SPK

/interface bridge add name=Lo100
/interface bridge add name=Lo5

/ip addr add address=10.{u}.45.5/29 interface=ether1 network=10.{u}.45.0
/ip addr add address=10.{u}.100.5/32 interface=Lo100 network=10.{u}.100.5
/ip addr add address=10.{u}.5.5/24 interface=Lo5 network=10.{u}.5.0

/routing ospf instance add name=OSPF-{u} router-id=10.{u}.100.5

/routing ospf area add instance=OSPF-{u} name=AREA-0 area-id=0.0.0.0

/routing ospf interface-template add area=AREA-0 interfaces=Lo100
/routing ospf interface-template add area=AREA-0 interfaces=Lo5
/routing ospf interface-template add area=AREA-0 interfaces=ether1

! backup that shit right now!!!!
! on cloud-gw
/system backup save name={user}-cloud-gw.backup
! on cloud-spk
/system backup save name={user}-cloud-spk.backup

! run the python script

.\x_remote.py .\w06-tsk2.yaml

! upload to tftp server
tftp -i 192.0.2.69 put {user}-w06-tsk2.txt

